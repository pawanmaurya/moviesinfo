function hash(a){return a.split("").reduce(function(a,b){return a=(a<<5)-a+b.charCodeAt(0),a&a})}var console={};console.log=function(){},$("#result").hide();var imdb={rating:{run:function(a){temp=a.resource.rating,isNaN(temp)&&(temp="-"),imdbRating="<p class = 'text-center'><b>"+temp+"</b></p>",temp=a.resource.title,isNaN(temp)&&(imdbMovieName=temp)}}},imdbRating=0,imdbMovieName,clickCounter=0,index_counter=0,moviesFoundCounter=0,tablePtr=0,stopSearching=0;$(document).ready(function(){function i(){$("#loading").html("<img src='load.gif' alt='loading...' />")}function j(){$("#loading").hide()}function k(){var a='<div class = "alert alert-danger "><button type="button" class="close" data-dismiss="alert" ><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>No video Files found :( </div>';return a}function l(a){var b='<div class = "alert alert-info ">'+a+' video files are found in your directory. Now searching for movie info.<span id = "numFoundText" > Movie info found for <span id = "numFound"></span> movies &nbsp;&nbsp;&nbsp; </span> <span id = "loading"></span> <button class="btn btn-danger btn-sm pull-right" id = "stop-search"><span class="glyphicon glyphicon-remove"></span> Stop Searching</button></div>';return b}function m(){var a=$("#example_wrapper").offset();$("html, body").animate({scrollTop:a.top},"slow"),u(),console.log(tablePtr)}function n(a){for(var c,b=["avi","mp4","flv","divx","mov","mkv","webm"],d=[],e=0,f=a.length;f>e;e++)if(c=a[e],extension=c.name.substr((~-c.name.lastIndexOf(".")>>>0)+2),extension&&b.indexOf(extension)>=0){var g=c.name.substring(0,c.name.lastIndexOf("."));d.indexOf(g)<0&&d.push(g)}return d}function o(a){function b(a){if("$"!=a.substring(0,1)){var b=["dvd","divx","xvid","brrip","r5","unrated","480p","720p","x264","klaxxon","axxo","br_300","300mb","cd1","cd2"," - ","$"," by "];if(a.toLowerCase().indexOf("sample")>=0)return"";a=a.replace(/\(.*?\)/g,""),a=a.replace(/\{.*?\}/g,""),a=a.replace(/\[.*?\]/g,""),a=a.replace(/\./g," "),a=a.replace(/_/g," "),a=a.replace(/ \d\d\d\d.*/,"");for(var d=0,e=b.length;e>d;d++){var f=new RegExp(b[d]+".*","ig");a=a.replace(f,"")}return a=a.replace(/\-/g," ")}}g=[];for(var c=[],d=[],e=0,f=a.length;f>e;e++){var h=b(a[e]);h&&d.indexOf(h)<0&&(c.push({index:e,name:h}),d.push(h))}return c}function p(){moviesFoundCounter=0,i(),console.log(d),index_counter||v(d[index_counter].name,d[index_counter].index)}function q(a,c,d){if(0==a.total_pages||!a.results)return f.push(d),console.log("=======no result for "),t(),void 0;var e=a.results,g=e[0].title;console.log("title "+g);var h=e[0].id,i="";$.ajax({url:"http://api.themoviedb.org/3/movie/"+h+"?api_key="+b,dataType:"json",dataType:"jsonp",success:function(a){if(console.log("getMoreMovieInfo"),i=a.imdb_id,!i)return console.log("imdbId not fond"),f.push(d),t(),void 0;var b='<a target="_blank" href = "http://www.imdb.com/title/'+i+'">'+g+"</a>",e="";for(var h in a.genres)e+=a.genres[h].name+" ";$.ajax({type:"GET",url:"http://p.media-imdb.com/static-content/documents/v1/title/"+i+"/ratings%3Fjsonp=imdb.rating.run:imdb.api.title.ratings/data.json",contentType:"application/json",dataType:"jsonp",success:function(){},error:function(){console.log("going to push"),r(b,e,i,c)}})},error:function(){console.log("error ========= getMoreMovieInfo"),t()}})}function r(a,b,c,d){var e="http://gdata.youtube.com/feeds/api/videos/?v=2&alt=jsonc";e+="&paid-content=false",e+="&duration=short",e+="&orderby=relevance&time=all_time",e+="&max-results=1";var f=encodeURI("official trailer "+imdbMovieName);e=e+"&q="+f,$.ajax({url:e,dataType:"jsonp",contentType:"application/json",success:function(e){var f="";if(console.log("pushObj_aux"),e.data.items){var g=e.data.items;console.log(g),g[0]&&(f='<a target="_blank" href="http://youtu.be/'+g[0].id+'"><img src = "youtube.png"/></a>')}s(a,b,c,d,f)},error:function(e){console.log("error=============="),console.log(e),s(a,b,c,d,"")}})}function s(a,b,d,e,f){console.log("here"),fileName=c[e],console.log(c),tablePtr.fnAddData([fileName,a,f,imdbRating,b],!1),tablePtr.fnStandingRedraw(),$("input[type=search]").css("width","200"),$(".dataTables_filter input").attr("placeholder","Filter by ratings, genres, names"),moviesFoundCounter++,$("#numFound").html("<b> "+moviesFoundCounter+" </b>"),$("#numFoundText").show(),t()}function t(){return stopSearching?void 0:(index_counter++,index_counter==d.length?(console.log("!!!!!!!!!!!!!! done"),console.log(f),j(),void 0):(v(d[index_counter].name,d[index_counter].index),void 0))}function u(){$("#movieInfo").show(),tablePtr=$("#movieInfo").dataTable({bAutoWidth:!1,sAjaxDataProp:"",bProcessing:!0,bDestroy:!0,bAutoWidth:!1,oLanguage:{sEmptyTable:"Searching for movie data ..."},order:[[3,"desc"]],aoColumns:[{sWidth:"30%"},{sWidth:"30%"},{sWidth:"5%"},{sWidth:"5%"},{sWidth:"30%"}],aoColumns:[{title:"Video files found"},{title:"Movie"},{title:"Trailer",sClass:"text-center"},{title:"Rating",sClass:"text-center"},{title:"Genres"}],data:g})}function v(a,c){console.log("starting ==",a);var a,f,d="http://api.themoviedb.org/3/",e="search/movie?query=",g="&api_key="+b;f=encodeURI(a),urlStr=d+e+f+g,$.ajax({type:"GET",url:urlStr,contentType:"application/json",dataType:"jsonp",success:function(b){console.log("getMovieInfo"),q(b,c,a)},error:function(){console.log("error=============="),t()}})}$("#proxyBtn").click(function(a){a.preventDefault(),$("#fileURL").trigger("click")});var a=document.getElementById("fileURL");a.addEventListener("change",function(a){stopSearching=0,$("#result").show(),b=a.target.files;var b;return c=n(b),d=o(c),0==d.length?($("#message").html(k()),void 0):($("#message").html(l(d.length)),$("#stop-search").click(function(){$("#stop-search").hide(),j(),stopSearching=1}),$("#numFoundText").hide(),clickCounter++?(tablePtr.fnClearTable(),index_counter=0,m()):m(),p(),void 0)},!1),$("#movieInfo").hide();var b="c340d5ff1e32511e4584f70860ab018c",c=[],d=[],f=[],g=[]});
