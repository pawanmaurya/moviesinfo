var console={};console.log=function(){},$(window).unload(function(){localStorage.setItem("sessionRunning",0)}),$("#result").hide();var imdb={rating:{run:function(a){imdbRating="<p class = 'text-center'><b>"+a.resource.rating+"</b></p>"}}},imdbRating=0,clickCounter=0,index_counter=0,moviesFoundCounter=0;$(document).ready(function(){function h(){var a=document.getElementById("loading");g=setInterval(function(){5==(a.innerHTML+=".").length&&(a.innerHTML="")},500)}function i(){document.getElementById("loading"),clearInterval(g),$("#loading").hide()}function j(){var a='<div class = "alert alert-danger "><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>This site is running in another tab too . Right now only one can run . Will fix this soon </div>';return a}function k(){var a='<div class = "alert alert-danger "><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>No video Files found :( </div>';return a}function l(a){var b='<div class = "alert alert-info "><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>'+a+' video files are found in your directory. Now searching for movie info.<span id = "numFoundText" > Movie info found for <span id = "numFound"></span> movies</span> <span id = "loading"></span</div>';return b}function m(){t()}function n(a){for(var c,b=["avi","mp4","flv","divx","mov","mkv","webm"],d=[],e=0,f=a.length;f>e;e++)if(c=a[e],extension=c.name.substr((~-c.name.lastIndexOf(".")>>>0)+2),extension&&b.indexOf(extension)>=0){var g=c.name.substring(0,c.name.lastIndexOf("."));d.indexOf(g)<0&&d.push(g)}return d}function o(a){function b(a){if("$"!=a.substring(0,1)){var b=["dvd","divx","xvid","brrip","r5","unrated","480p","720p","x264","klaxxon","axxo","br_300","300mb","cd1","cd2"," - ","$"," by "];if(a.toLowerCase().indexOf("sample")>=0)return"";a=a.replace(/\(.*?\)/g,""),a=a.replace(/\{.*?\}/g,""),a=a.replace(/\[.*?\]/g,""),a=a.replace(/\./g," "),a=a.replace(/_/g," "),a=a.replace(/ \d\d\d\d.*/,"");for(var d=0,e=b.length;e>d;d++){var f=new RegExp(b[d]+".*","ig");a=a.replace(f,"")}return a=a.replace(/\-/g," ")}}for(var c=[],d=[],e=0,f=a.length;f>e;e++){var g=b(a[e]);g&&d.indexOf(g)<0&&(c.push({index:e,name:g}),d.push(g))}return c}function p(){var a=$("#example_wrapper").offset();$("html, body").animate({scrollTop:a.top},"slow"),moviesFoundCounter=0,h(),console.log(d),localStorage.setItem("sessionRunning",1),index_counter||u(d[index_counter].name,d[index_counter].index)}function q(a,c,d){if(0==a.total_pages||!a.results)return f.push(d),console.log("=======no result for "),s(),void 0;var e=a.results,g=e[0].title;console.log("title "+g);var h=e[0].id,i="";$.ajax({url:"http://api.themoviedb.org/3/movie/"+h+"?api_key="+b,dataType:"json",dataType:"jsonp",success:function(a){if(console.log("getMoreMovieInfo"),i=a.imdb_id,!i)return console.log("imdbId not fond"),f.push(d),s(),void 0;var b='<a target="_blank" href = "http://www.imdb.com/title/'+i+'">'+g+"</a>",e="";for(var h in a.genres)e+=a.genres[h].name+" ";$.ajax({type:"GET",url:"http://p.media-imdb.com/static-content/documents/v1/title/"+i+"/ratings%3Fjsonp=imdb.rating.run:imdb.api.title.ratings/data.json",contentType:"application/json",dataType:"jsonp",success:function(){alert(3)},error:function(){console.log("going to push"),r(b,e,i,c)}})},error:function(){console.log("error ========= getMoreMovieInfo"),s()}})}function r(a,b,d,e){var f=JSON.parse(localStorage.getItem("dataTablesData"));f.push({fileName:c[e],movie:a,rating:imdbRating,genres:b,imdbId:d}),localStorage.setItem("dataTablesData",JSON.stringify(f));var g=$("#movieInfo").DataTable();console.log("pushObj"),g.ajax.reload(),$("input[type=search]").css("width","200"),$(".dataTables_filter input").attr("placeholder","Filter by ratings, genres, names"),moviesFoundCounter++,$("#numFound").html("<b> "+moviesFoundCounter+" </b>"),$("#numFoundText").show(),s()}function s(){return index_counter++,index_counter==d.length?(console.log("!!!!!!!!!!!!!! done"),console.log(f),i(),localStorage.setItem("sessionRunning",0),void 0):(u(d[index_counter].name,d[index_counter].index),void 0)}function t(){$("#movieInfo").show(),$("#movieInfo").dataTable({bAutoWidth:!1,sAjaxDataProp:"",bProcessing:!0,oLanguage:{sEmptyTable:"Searching for movie data ..."},order:[[2,"desc"]],aoColumns:[{sWidth:"30%"},{sWidth:"35%"},{sWidth:"5%"},{sWidth:"30%"}],aoColumns:[{mData:"fileName"},{mData:"movie"},{mData:"rating"},{mData:"genres"}],ajax:function(a,b){b(JSON.parse(localStorage.getItem("dataTablesData")))}})}function u(a,c){console.log("starting ==",a);var a,f,d="http://api.themoviedb.org/3/",e="search/movie?query=",g="&api_key="+b;f=encodeURI(a),urlStr=d+e+f+g,$.ajax({type:"GET",url:urlStr,contentType:"application/json",dataType:"jsonp",success:function(b){console.log("getMovieInfo"),q(b,c,a)},error:function(){console.log("error=============="),s()}})}$("#proxyBtn").click(function(a){a.preventDefault(),$("#fileURL").trigger("click")});var a=document.getElementById("fileURL");a.addEventListener("change",function(a){$("#result").show();var b=localStorage.getItem("sessionRunning");if(console.log(b),1==b)return $("#message").html(j()),void 0;localStorage.clear(),localStorage.setItem("dataTablesData","[]"),e=a.target.files;var e;if(c=n(e),d=o(c),0==d.length)return $("#message").html(k()),void 0;if($("#message").html(l(d.length)),$("#numFoundText").hide(),clickCounter++){localStorage.clear(),localStorage.setItem("dataTablesData","[]");var g=$("#movieInfo").DataTable();g.clear().draw(),index_counter=0}else m();p()},!1),$("#movieInfo").hide();var g,b="c340d5ff1e32511e4584f70860ab018c",c=[],d=[],f=[]});
